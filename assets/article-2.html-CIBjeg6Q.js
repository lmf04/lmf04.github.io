import{_ as a,e as t,g as r,o as n}from"./app-BY3UUy9i.js";const s={};function o(i,e){return n(),t("div",null,e[0]||(e[0]=[r(`<p>This code block is used to set up the environment and load the R packages required for subsequent analysis.</p><h1 id="this-code-is-used-to-generate-regional-correlation-matrices-and-metrics-corresponding-to-extended-data-fig-3d-k" tabindex="-1"><a class="header-anchor" href="#this-code-is-used-to-generate-regional-correlation-matrices-and-metrics-corresponding-to-extended-data-fig-3d-k"><span>This code is used to generate regional correlation matrices and metrics, corresponding to Extended Data Fig. 3d - k</span></a></h1><h1 id="using-excitatory-neurons-as-an-example-for-analysis" tabindex="-1"><a class="header-anchor" href="#using-excitatory-neurons-as-an-example-for-analysis"><span>Using excitatory neurons as an example for analysis</span></a></h1><h1 id="load-necessary-libraries" tabindex="-1"><a class="header-anchor" href="#load-necessary-libraries"><span>Load necessary libraries</span></a></h1><p>library(Seurat) # A powerful toolkit for single-cell RNA sequencing data analysis library(ggplot2) # For creating high-quality graphics library(patchwork) # For combining multiple ggplot graphics library(magrittr) # Provides the pipe operator %&gt;% library(tidyverse) # Contains several commonly used packages for data processing and visualization library(pheatmap) # For drawing heatmaps library(palr) # Provides color palettes</p><h1 id="this-code-block-is-used-to-generate-the-correlation-matrix-between-cell-types-at-a-given-age" tabindex="-1"><a class="header-anchor" href="#this-code-block-is-used-to-generate-the-correlation-matrix-between-cell-types-at-a-given-age"><span>This code block is used to generate the correlation matrix between cell types at a given age.</span></a></h1><h1 id="this-part-generates-matrices-as-shown-in-extended-data-fig-3d-e-g-h-using-fig-e-excitatory-neurons-at-age-p65-as-an-example" tabindex="-1"><a class="header-anchor" href="#this-part-generates-matrices-as-shown-in-extended-data-fig-3d-e-g-h-using-fig-e-excitatory-neurons-at-age-p65-as-an-example"><span>This part generates matrices as shown in Extended Data Fig. 3d, e, g, h, using Fig. e (excitatory neurons at age P65) as an example.</span></a></h1><h1 id="load-the-merged-data" tabindex="-1"><a class="header-anchor" href="#load-the-merged-data"><span>Load the merged data.</span></a></h1><h1 id="the-merged-data-contains-only-excitatory-neurons-the-operation-is-the-same-if-analyzing-inhibitory-neurons-just-run-separately-for-each" tabindex="-1"><a class="header-anchor" href="#the-merged-data-contains-only-excitatory-neurons-the-operation-is-the-same-if-analyzing-inhibitory-neurons-just-run-separately-for-each"><span>The merged data contains only excitatory neurons (the operation is the same if analyzing inhibitory neurons, just run separately for each).</span></a></h1><h1 id="these-data-are-merged-across-all-ages-and-then-normalized-using-sctransform-across-the-entire-dataset" tabindex="-1"><a class="header-anchor" href="#these-data-are-merged-across-all-ages-and-then-normalized-using-sctransform-across-the-entire-dataset"><span>These data are merged across all ages and then normalized using SCTransform across the entire dataset.</span></a></h1><p>excit.merge &lt;- readRDS(&quot;&quot;)</p><h1 id="extract-data-for-age-p65-from-the-merged-data" tabindex="-1"><a class="header-anchor" href="#extract-data-for-age-p65-from-the-merged-data"><span>Extract data for age P65 from the merged data</span></a></h1><p>p65 &lt;- subset(excit.merge, subset = age == &quot;p65&quot;)</p><h1 id="sort-the-cell-type-names" tabindex="-1"><a class="header-anchor" href="#sort-the-cell-type-names"><span>Sort the cell type names</span></a></h1><p>celltypes &lt;- names(table(p65$my.cell.type)) celltypes &lt;- c(celltypes[1:19], celltypes[21:28], celltypes[20], celltypes[29:37], celltypes[39:46], celltypes[38], celltypes[47], celltypes[50:57], celltypes[48:49], celltypes[58:64])</p><h1 id="reorder-the-cell-types" tabindex="-1"><a class="header-anchor" href="#reorder-the-cell-types"><span>Reorder the cell types</span></a></h1><p>new.order &lt;- c(grep(&quot;B&quot;, celltypes), grep(&quot;H&quot;, celltypes), grep(&quot;L&quot;, celltypes), grep(&quot;C&quot;, celltypes), grep(&quot;F&quot;, celltypes), grep(&quot;M&quot;, celltypes), grep(&quot;N&quot;, celltypes), grep(&quot;A&quot;, celltypes), grep(&quot;P&quot;, celltypes), grep(&quot;T&quot;, celltypes), grep(&quot;X&quot;, celltypes)) celltypes &lt;- celltypes[new.order]</p><h1 id="set-parameters-number-of-feature-genes" tabindex="-1"><a class="header-anchor" href="#set-parameters-number-of-feature-genes"><span>Set parameters: number of feature genes</span></a></h1><p>nfeatures = 20000</p><h1 id="set-the-default-assay-to-rna" tabindex="-1"><a class="header-anchor" href="#set-the-default-assay-to-rna"><span>Set the default assay to RNA</span></a></h1><p>DefaultAssay(p65) &lt;- &quot;RNA&quot;</p><h1 id="find-variable-feature-genes" tabindex="-1"><a class="header-anchor" href="#find-variable-feature-genes"><span>Find variable feature genes</span></a></h1><p>p65 &lt;- FindVariableFeatures(p65, nfeatures = nfeatures)</p><h1 id="scale-the-data" tabindex="-1"><a class="header-anchor" href="#scale-the-data"><span>Scale the data</span></a></h1><p>p65 &lt;- ScaleData(p65)</p><h1 id="generate-the-centroid-matrix-which-will-serve-as-input-for-the-corr-function" tabindex="-1"><a class="header-anchor" href="#generate-the-centroid-matrix-which-will-serve-as-input-for-the-corr-function"><span>Generate the centroid matrix, which will serve as input for the corr() function</span></a></h1><p>centroid.mat &lt;- matrix(, nrow = length(celltypes), ncol = nfeatures) for (i in 1:length(celltypes)) {</p><h1 id="print-progress-information-every-10-cell-types" tabindex="-1"><a class="header-anchor" href="#print-progress-information-every-10-cell-types"><span>Print progress information every 10 cell types</span></a></h1><p>if (i %% 10 == 0) { print(paste0(&quot;on cell type number &quot;, i)) }</p><h1 id="skip-cell-types-with-fewer-than-2-cells" tabindex="-1"><a class="header-anchor" href="#skip-cell-types-with-fewer-than-2-cells"><span>Skip cell types with fewer than 2 cells</span></a></h1><p>if (table(p65$my.cell.type)[i] &lt; 2) { print(&quot;NOTE: this cell type has less than 2 cells. skipping...&quot;) next }</p><h1 id="extract-data-for-the-current-cell-type" tabindex="-1"><a class="header-anchor" href="#extract-data-for-the-current-cell-type"><span>Extract data for the current cell type</span></a></h1><p>ct.sub &lt;- subset(p65, subset = my.cell.type == celltypes[i])</p><h1 id="get-the-scaled-data-matrix" tabindex="-1"><a class="header-anchor" href="#get-the-scaled-data-matrix"><span>Get the scaled data matrix</span></a></h1><p>scaledata.mat &lt;- ct.sub@assays$RNA@scale.data</p><h1 id="calculate-the-centroid-for-the-current-cell-type-i-e-the-mean-per-row" tabindex="-1"><a class="header-anchor" href="#calculate-the-centroid-for-the-current-cell-type-i-e-the-mean-per-row"><span>Calculate the centroid for the current cell type (i.e., the mean per row)</span></a></h1><p>centroid.mat[i, ] &lt;- rowMeans(scaledata.mat) }</p><h1 id="calculate-the-correlation-matrix-of-the-centroid-matrix" tabindex="-1"><a class="header-anchor" href="#calculate-the-correlation-matrix-of-the-centroid-matrix"><span>Calculate the correlation matrix of the centroid matrix</span></a></h1><p>p65.corrmat &lt;- cor(t(centroid.mat))</p><h1 id="set-the-row-and-column-names-of-the-correlation-matrix" tabindex="-1"><a class="header-anchor" href="#set-the-row-and-column-names-of-the-correlation-matrix"><span>Set the row and column names of the correlation matrix</span></a></h1><p>rownames(p65.corrmat) &lt;- celltypes colnames(p65.corrmat) &lt;- celltypes</p><h1 id="draw-the-heatmap-without-row-and-column-clustering" tabindex="-1"><a class="header-anchor" href="#draw-the-heatmap-without-row-and-column-clustering"><span>Draw the heatmap without row and column clustering</span></a></h1><p>pheatmap(p65.corrmat, cluster_rows = F, cluster_cols = F, border_color = NA)</p><h1 id="scale-the-correlation-matrix" tabindex="-1"><a class="header-anchor" href="#scale-the-correlation-matrix"><span>Scale the correlation matrix</span></a></h1><p>scale.max &lt;- 0.5 scale.min &lt;- -0.2 scale.corrmat &lt;- p65.corrmat</p><h1 id="set-values-greater-than-scale-max-to-scale-max" tabindex="-1"><a class="header-anchor" href="#set-values-greater-than-scale-max-to-scale-max"><span>Set values greater than scale.max to scale.max</span></a></h1><p>scale.corrmat[scale.corrmat &gt; scale.max] &lt;- scale.max</p><h1 id="set-values-less-than-scale-min-to-scale-min" tabindex="-1"><a class="header-anchor" href="#set-values-less-than-scale-min-to-scale-min"><span>Set values less than scale.min to scale.min</span></a></h1><p>scale.corrmat[scale.corrmat &lt; scale.min] &lt;- scale.min</p><h1 id="draw-the-scaled-heatmap" tabindex="-1"><a class="header-anchor" href="#draw-the-scaled-heatmap"><span>Draw the scaled heatmap</span></a></h1><p>pheatmap(scale.corrmat, cluster_rows = F, cluster_cols = F, border_color = NA)</p><h1 id="this-code-block-is-used-to-generate-the-expression-of-regional-marker-genes-at-each-age" tabindex="-1"><a class="header-anchor" href="#this-code-block-is-used-to-generate-the-expression-of-regional-marker-genes-at-each-age"><span>This code block is used to generate the expression of regional marker genes at each age.</span></a></h1><h1 id="this-part-of-the-code-generates-extended-data-fig-3j-k" tabindex="-1"><a class="header-anchor" href="#this-part-of-the-code-generates-extended-data-fig-3j-k"><span>This part of the code generates Extended Data Fig. 3j - k.</span></a></h1><h1 id="first-create-a-function-for-plotting-heatmaps" tabindex="-1"><a class="header-anchor" href="#first-create-a-function-for-plotting-heatmaps"><span>First, create a function for plotting heatmaps.</span></a></h1><p>avg.gene.heatmap &lt;- function(obj, br.or.ct, # &quot;br&quot; for operation by brain region, &quot;ct&quot; for operation by cell type identity.rows, # Cell type or brain region names in order gene.columns, # Gene names in order scale.max = 2, # Maximum value for scaling heatmap data scale.min = 0, # Minimum value for scaling heatmap data return.matrix = 0) { # Whether to return the heatmap matrix, 0 for no, 1 for yes</p><h1 id="set-the-default-assay-to-rna-1" tabindex="-1"><a class="header-anchor" href="#set-the-default-assay-to-rna-1"><span>Set the default assay to RNA</span></a></h1><p>DefaultAssay(obj) &lt;- &quot;RNA&quot;</p><h1 id="set-all-genes-as-variable-features-for-subsequent-scaling" tabindex="-1"><a class="header-anchor" href="#set-all-genes-as-variable-features-for-subsequent-scaling"><span>Set all genes as variable features for subsequent scaling</span></a></h1><p>VariableFeatures(obj) &lt;- rownames(obj)</p><h1 id="scale-the-data-1" tabindex="-1"><a class="header-anchor" href="#scale-the-data-1"><span>Scale the data</span></a></h1><p>obj &lt;- ScaleData(obj)</p><h1 id="initialize-an-empty-matrix-to-store-the-heatmap-data" tabindex="-1"><a class="header-anchor" href="#initialize-an-empty-matrix-to-store-the-heatmap-data"><span>Initialize an empty matrix to store the heatmap data</span></a></h1><p>heatmap.to.plot &lt;- matrix(, nrow = length(identity.rows), ncol = length(gene.columns))</p><h1 id="iterate-over-each-row-cell-type-or-brain-region" tabindex="-1"><a class="header-anchor" href="#iterate-over-each-row-cell-type-or-brain-region"><span>Iterate over each row (cell type or brain region)</span></a></h1><p>for (ident.row in 1:length(identity.rows)) { if (br.or.ct == &quot;br&quot;) { # If operating by brain region, extract data for the corresponding brain region ident.sub &lt;- subset(obj, subset = brain.region == identity.rows[ident.row]) } if (br.or.ct == &quot;ct&quot;) { # If operating by cell type, extract data for the corresponding cell type ident.sub &lt;- subset(obj, subset = my.cell.type == identity.rows[ident.row]) }</p><pre><code># Iterate over each column (gene)
for (gene in 1:length(gene.columns)) {
  # Find the index of the current gene in the data
  gene.ind &lt;- grep(paste0(&quot;^&quot;, gene.columns[gene], &quot;$&quot;), rownames(ident.sub))

  # Calculate the average expression value of the current gene in the current cell type or brain region and store it in the heatmap matrix
  heatmap.to.plot[ident.row, gene] &lt;- mean(ident.sub@assays$RNA@scale.data[gene.ind, ])
}
</code></pre><p>}</p><h1 id="set-the-row-and-column-names-of-the-heatmap-matrix" tabindex="-1"><a class="header-anchor" href="#set-the-row-and-column-names-of-the-heatmap-matrix"><span>Set the row and column names of the heatmap matrix</span></a></h1><p>rownames(heatmap.to.plot) &lt;- identity.rows colnames(heatmap.to.plot) &lt;- gene.columns</p><h1 id="scale-the-heatmap-matrix" tabindex="-1"><a class="header-anchor" href="#scale-the-heatmap-matrix"><span>Scale the heatmap matrix</span></a></h1><p>heatmap.to.plot.scaled &lt;- heatmap.to.plot heatmap.to.plot.scaled[heatmap.to.plot.scaled &gt; scale.max] &lt;- scale.max heatmap.to.plot.scaled[heatmap.to.plot.scaled &lt; scale.min] &lt;- scale.min</p><h1 id="draw-the-heatmap-without-row-and-column-clustering-using-a-reversed-color-palette" tabindex="-1"><a class="header-anchor" href="#draw-the-heatmap-without-row-and-column-clustering-using-a-reversed-color-palette"><span>Draw the heatmap without row and column clustering, using a reversed color palette</span></a></h1><p>pheatmap(t(heatmap.to.plot.scaled), cluster_rows = F, cluster_cols = F, color = rev(bathy_deep_pal(50)), border_color = NA)</p><h1 id="if-return-matrix-is-1-return-the-heatmap-matrix" tabindex="-1"><a class="header-anchor" href="#if-return-matrix-is-1-return-the-heatmap-matrix"><span>If return.matrix is 1, return the heatmap matrix</span></a></h1><p>if (return.matrix == 1) { return(heatmap.to.plot) } }</p><h1 id="now-get-the-marker-genes-and-plot-the-heatmap" tabindex="-1"><a class="header-anchor" href="#now-get-the-marker-genes-and-plot-the-heatmap"><span>Now get the marker genes and plot the heatmap.</span></a></h1><h1 id="convert-the-brain-regions-in-the-merged-data-to-factor-type-and-specify-the-level-order" tabindex="-1"><a class="header-anchor" href="#convert-the-brain-regions-in-the-merged-data-to-factor-type-and-specify-the-level-order"><span>Convert the brain regions in the merged data to factor type and specify the level order.</span></a></h1><p>excit.merge$brain.region &lt;- factor(excit.merge$brain.region, levels = c(&quot;BNST&quot;, &quot;HDB.VLPO&quot;, &quot;LPO.PS&quot;, &quot;BAC-like&quot;, &quot;PeFA&quot;, &quot;MPN.anterior&quot;, &quot;MPN.posterior&quot;, &quot;AvPE.MnPO&quot;, &quot;PVN&quot;, &quot;PVT&quot;, &quot;Mixed/Unknown&quot;))</p><h1 id="set-the-identity-to-brain-region-for-subsequent-analysis" tabindex="-1"><a class="header-anchor" href="#set-the-identity-to-brain-region-for-subsequent-analysis"><span>Set the identity to brain region for subsequent analysis.</span></a></h1><p>Idents(excit.merge) &lt;- &quot;brain.region&quot;</p><h1 id="data-preparation" tabindex="-1"><a class="header-anchor" href="#data-preparation"><span>Data preparation</span></a></h1><h1 id="extract-data-for-age-p65" tabindex="-1"><a class="header-anchor" href="#extract-data-for-age-p65"><span>Extract data for age P65</span></a></h1><p>excit.p65 &lt;- subset(excit.merge, subset = age == &quot;p65&quot;)</p><h1 id="extract-data-for-age-e16" tabindex="-1"><a class="header-anchor" href="#extract-data-for-age-e16"><span>Extract data for age E16</span></a></h1><p>excit.e16 &lt;- subset(excit.merge, subset = age == &quot;e16&quot;)</p><h1 id="get-the-names-of-all-brain-regions" tabindex="-1"><a class="header-anchor" href="#get-the-names-of-all-brain-regions"><span>Get the names of all brain regions</span></a></h1><p>all.br &lt;- names(table(excit.p65$brain.region))</p><h1 id="get-regional-marker-genes-for-age-p65" tabindex="-1"><a class="header-anchor" href="#get-regional-marker-genes-for-age-p65"><span>Get regional marker genes for age P65</span></a></h1><p>region.markers.p65 &lt;- FindAllMarkers(excit.p65, assay = &quot;RNA&quot;, only.pos = T)</p><h1 id="filter-marker-genes-with-adjusted-p-value-less-than-0-05" tabindex="-1"><a class="header-anchor" href="#filter-marker-genes-with-adjusted-p-value-less-than-0-05"><span>Filter marker genes with adjusted p-value less than 0.05</span></a></h1><p>region.markers.p65 &lt;- region.markers.p65[region.markers.p65$p_val_adj &lt; 0.05, ]</p><h1 id="filter-marker-genes-with-average-log2-fold-change-greater-than-0-5" tabindex="-1"><a class="header-anchor" href="#filter-marker-genes-with-average-log2-fold-change-greater-than-0-5"><span>Filter marker genes with average log2 fold change greater than 0.5</span></a></h1><p>region.markers.p65 &lt;- region.markers.p65[region.markers.p65$avg_log2FC &gt; 0.5, ]</p><h1 id="remove-duplicate-marker-genes" tabindex="-1"><a class="header-anchor" href="#remove-duplicate-marker-genes"><span>Remove duplicate marker genes</span></a></h1><p>region.markers.p65 &lt;- region.markers.p65$gene[-which(duplicated(region.markers.p65$gene))]</p><h1 id="display-the-expression-of-p65-marker-genes-at-p65-age-in-a-heatmap" tabindex="-1"><a class="header-anchor" href="#display-the-expression-of-p65-marker-genes-at-p65-age-in-a-heatmap"><span>Display the expression of P65 marker genes at P65 age in a heatmap.</span></a></h1><p>avg.gene.heatmap(excit.p65, &quot;br&quot;, all.br, region.markers.p65)</p><h1 id="now-test-the-expression-of-p65-genes-at-e16-age" tabindex="-1"><a class="header-anchor" href="#now-test-the-expression-of-p65-genes-at-e16-age"><span>Now test the expression of P65 genes at E16 age.</span></a></h1><p>avg.gene.heatmap(excit.e16, &quot;br&quot;, all.br, region.markers.p65)</p><h1 id="conversely-get-regional-marker-genes-for-age-e16" tabindex="-1"><a class="header-anchor" href="#conversely-get-regional-marker-genes-for-age-e16"><span>Conversely, get regional marker genes for age E16.</span></a></h1><p>region.markers.e16 &lt;- FindAllMarkers(excit.e16, assay = &quot;RNA&quot;, only.pos = T)</p><h1 id="filter-marker-genes-with-adjusted-p-value-less-than-0-05-1" tabindex="-1"><a class="header-anchor" href="#filter-marker-genes-with-adjusted-p-value-less-than-0-05-1"><span>Filter marker genes with adjusted p-value less than 0.05</span></a></h1><p>region.markers.e16 &lt;- region.markers.e16[region.markers.e16$p_val_adj &lt; 0.05, ]</p><h1 id="filter-marker-genes-with-average-log2-fold-change-greater-than-0-5-1" tabindex="-1"><a class="header-anchor" href="#filter-marker-genes-with-average-log2-fold-change-greater-than-0-5-1"><span>Filter marker genes with average log2 fold change greater than 0.5</span></a></h1><p>region.markers.e16 &lt;- region.markers.e16[region.markers.e16$avg_log2FC &gt; 0.5, ]</p><h1 id="remove-duplicate-marker-genes-1" tabindex="-1"><a class="header-anchor" href="#remove-duplicate-marker-genes-1"><span>Remove duplicate marker genes</span></a></h1><p>region.markers.e16 &lt;- region.markers.e16$gene[-which(duplicated(region.markers.e16$gene))]</p><h1 id="display-the-expression-of-e16-marker-genes-at-e16-age-in-a-heatmap" tabindex="-1"><a class="header-anchor" href="#display-the-expression-of-e16-marker-genes-at-e16-age-in-a-heatmap"><span>Display the expression of E16 marker genes at E16 age in a heatmap.</span></a></h1><p>avg.gene.heatmap(excit.e16, &quot;br&quot;, all.br, region.markers.e16)</p><h1 id="now-test-the-expression-of-e16-genes-at-p65-age" tabindex="-1"><a class="header-anchor" href="#now-test-the-expression-of-e16-genes-at-p65-age"><span>Now test the expression of E16 genes at P65 age.</span></a></h1><p>avg.gene.heatmap(excit.p65, &quot;br&quot;, all.br, region.markers.e16)</p><h1 id="now-remove-marker-genes-that-appear-in-both-lists-and-replot-the-heatmaps" tabindex="-1"><a class="header-anchor" href="#now-remove-marker-genes-that-appear-in-both-lists-and-replot-the-heatmaps"><span>Now remove marker genes that appear in both lists and replot the heatmaps.</span></a></h1><h1 id="get-marker-genes-unique-to-p65" tabindex="-1"><a class="header-anchor" href="#get-marker-genes-unique-to-p65"><span>Get marker genes unique to P65</span></a></h1><p>unique.p65.markers &lt;- setdiff(region.markers.p65, region.markers.e16)</p><h1 id="get-marker-genes-unique-to-e16" tabindex="-1"><a class="header-anchor" href="#get-marker-genes-unique-to-e16"><span>Get marker genes unique to E16</span></a></h1><p>unique.e16.markers &lt;- setdiff(region.markers.e16, region.markers.p65)</p><h1 id="plot-the-relevant-heatmaps" tabindex="-1"><a class="header-anchor" href="#plot-the-relevant-heatmaps"><span>Plot the relevant heatmaps.</span></a></h1><p>avg.gene.heatmap(excit.p65, &quot;br&quot;, all.br, unique.p65.markers) avg.gene.heatmap(excit.e16, &quot;br&quot;, all.br, unique.p65.markers) avg.gene.heatmap(excit.e16, &quot;br&quot;, all.br, unique.e16.markers) avg.gene.heatmap(excit.p65, &quot;br&quot;, all.br, unique.e16.markers)</p><h1 id="now-explore-at-what-age-does-the-marker-gene-expression-pattern-begin-to-resemble-adulthood" tabindex="-1"><a class="header-anchor" href="#now-explore-at-what-age-does-the-marker-gene-expression-pattern-begin-to-resemble-adulthood"><span>Now, explore: At what age does the marker gene expression pattern begin to resemble adulthood?</span></a></h1><h1 id="simply-analyze-by-matrix-subtraction" tabindex="-1"><a class="header-anchor" href="#simply-analyze-by-matrix-subtraction"><span>Simply analyze by matrix subtraction.</span></a></h1><h1 id="extract-data-for-different-ages" tabindex="-1"><a class="header-anchor" href="#extract-data-for-different-ages"><span>Extract data for different ages</span></a></h1><p>excit.p28 &lt;- subset(excit.merge.noNA, subset = age == &quot;p28&quot;) excit.p18 &lt;- subset(excit.merge.noNA, subset = age == &quot;p18&quot;) excit.p10 &lt;- subset(excit.merge.noNA, subset = age == &quot;p10&quot;) excit.p4 &lt;- subset(excit.merge.noNA, subset = age == &quot;p4&quot;) excit.p0 &lt;- subset(excit.merge.noNA, subset = age == &quot;p0&quot;) excit.e18 &lt;- subset(excit.merge.noNA, subset = age == &quot;e18&quot;)</p><h1 id="for-p65-marker-genes-excluding-e16-marker-genes" tabindex="-1"><a class="header-anchor" href="#for-p65-marker-genes-excluding-e16-marker-genes"><span>For P65 marker genes (excluding E16 marker genes)</span></a></h1><h1 id="get-the-expression-matrix-of-these-marker-genes-at-different-ages" tabindex="-1"><a class="header-anchor" href="#get-the-expression-matrix-of-these-marker-genes-at-different-ages"><span>Get the expression matrix of these marker genes at different ages</span></a></h1><p>p65.mat &lt;- avg.gene.heatmap(excit.p65, &quot;br&quot;, all.br, unique.p65.markers, return.matrix = 1) p28.mat &lt;- avg.gene.heatmap(excit.p28, &quot;br&quot;, all.br, unique.p65.markers, return.matrix = 1) p18.mat &lt;- avg.gene.heatmap(excit.p18, &quot;br&quot;, all.br, unique.p65.markers, return.matrix = 1) p10.mat &lt;- avg.gene.heatmap(excit.p10, &quot;br&quot;, all.br, unique.p65.markers, return.matrix = 1) p4.mat &lt;- avg.gene.heatmap(excit.p4, &quot;br&quot;, all.br, unique.p65.markers, return.matrix = 1) p0.mat &lt;- avg.gene.heatmap(excit.p0, &quot;br&quot;, all.br, unique.p65.markers, return.matrix = 1) e18.mat &lt;- avg.gene.heatmap(excit.e18, &quot;br&quot;, all.br, unique.p65.markers, return.matrix = 1) e16.mat &lt;- avg.gene.heatmap(excit.e16, &quot;br&quot;, all.br, unique.p65.markers, return.matrix = 1)</p><h1 id="calculate-the-correlation-between-the-expression-matrix-at-different-ages-and-the-expression-matrix-at-p65-age" tabindex="-1"><a class="header-anchor" href="#calculate-the-correlation-between-the-expression-matrix-at-different-ages-and-the-expression-matrix-at-p65-age"><span>Calculate the correlation between the expression matrix at different ages and the expression matrix at P65 age.</span></a></h1><p>cor.to.p65 &lt;- data.frame(age = 1:8, cor = c(cor(c(e16.mat), c(p65.mat)), cor(c(e18.mat), c(p65.mat)), cor(c(p0.mat), c(p65.mat)), cor(c(p4.mat), c(p65.mat)), cor(c(p10.mat), c(p65.mat)), cor(c(p18.mat), c(p65.mat)), cor(c(p28.mat), c(p65.mat)), 1 ))</p><h1 id="draw-a-line-plot-of-correlation-changing-with-age" tabindex="-1"><a class="header-anchor" href="#draw-a-line-plot-of-correlation-changing-with-age"><span>Draw a line plot of correlation changing with age.</span></a></h1><p>ggplot(cor.to.p65, aes(x = age, y = cor)) + geom_line(aes(linewidth = 4)) + theme_classic() + ylim(0.3, 1) + theme(text = element_text(family = &quot;Myriad Pro&quot;)) + theme(text = element_text(size = 20))</p>`,129)]))}const h=a(s,[["render",o],["__file","article-2.html.vue"]]),p=JSON.parse(`{"path":"/blog/article-2.html","title":"This Set of Bioinformatics Analysis Code from Harvard University's Nature Paper is Worth Learning","lang":"en-US","frontmatter":{"layout":"BlogPost","date":"2025.02.12","archive":true,"title":"This Set of Bioinformatics Analysis Code from Harvard University's Nature Paper is Worth Learning","description":"Recently, a research team from Harvard University published an important study in the journal Nature. This research delved into the developmental trajectory of neurons in the mammalian hypothalamic preoptic area (POA), revealing the significant influence of factors such as sensory input, sex, and function on their development. It provides a new perspective for understanding the neural basis of instinctive behaviors."},"headers":[],"git":{"updatedTime":1756009719000,"contributors":[{"name":"limengli","username":"limengli","email":"limengli@qq.com","commits":2,"url":"https://github.com/limengli"}],"changelog":[{"hash":"84a449896542c2afd785917d68f97d41e64b66fb","time":1756009719000,"email":"limengli@qq.com","author":"limengli","message":"update"},{"hash":"33fb064215db0208e223b56976bfe0fd34434077","time":1754478598000,"email":"limengli@qq.com","author":"limengli","message":"web"}]},"filePathRelative":"blog/article-2.md","excerpt":"<p>This code block is used to set up the environment and load the R packages required for subsequent analysis.</p>\\n<h1>This code is used to generate regional correlation matrices and metrics, corresponding to Extended Data Fig. 3d - k</h1>\\n<h1>Using excitatory neurons as an example for analysis</h1>"}`);export{h as comp,p as data};
